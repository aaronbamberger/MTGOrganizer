version: '3'
services:
    card_db:
        image: "mariadb:latest"
        command: --max-connections 1000 --innodb-lock-wait-timeout 300 --max-prepared-stmt-count 50000
        volumes:
            - ../../container-volumes/mariadb:/var/lib/mysql
        environment:
            MYSQL_ROOT_PASSWORD: db_password
            MYSQL_DATABASE: mtg_cards
            MYSQL_USER: app_user
            MYSQL_PASSWORD: app_db_password
    phpmyadmin:
        image: "phpmyadmin/phpmyadmin:latest"
        ports:
            - "8082:80"
        environment:
            PMA_HOST: card_db
            PMA_USER: app_user
            PMA_PASSWORD: app_db_password
    card_prices_db:
        image: "influxdb:latest"
        volumes:
            - ../../container-volumes/influxdb:/var/lib/influxdb
        ports:
            - "8086:8086"
        environment:
            INFLUXDB_DB: mtg_cards
            INFLUXDB_ADMIN_USER: admin_user
            INFLUXDB_ADMIN_PASSWORD: admin_password
            INFLUXDB_USER: app_user
            INFLUXDB_USER_PASSWORD: app_db_password
    grafana:
        image: "grafana/grafana:latest"
        volumes:
            - ../../container-volumes/grafana:/var/lib/grafana
        ports:
            - "3000:3000"
        environment:
            #GF_DATABASE_TYPE: mysql
            #GF_DATABASE_HOST: card_db
            #GF_DATABASE_NAME: grafana
            #GF_DATABASE_USER: app_user
            #GF_DATABASE_PASSWORD: add_db_password
            GF_SECURITY_ADMIN_USER: grafana_admin
            GF_SECURITY_ADMIN_PASSWORD: grafana_admin_password
